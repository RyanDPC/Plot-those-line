% Header configuration for Pandoc → PDF (LaTeX)
% Logo à droite (sauf page de garde où il est centré), pas de titre centré, numéro page en footer

\usepackage{graphicx}
% Set document fonts (XeLaTeX)
\usepackage{fontspec}
\setmainfont{Times New Roman}
\setsansfont{Arial}
\setmonofont{Consolas}
\usepackage{titlesec}
\usepackage{float} % allow [H] placement
\usepackage{tocloft} % control ToC fonts

% ToC typography: use main serif font (Times) and larger title
\renewcommand{\cfttoctitlefont}{\Large\bfseries}
\renewcommand{\cftsecfont}{\normalsize\rmfamily}
\renewcommand{\cftsecpagefont}{\normalsize\rmfamily}
\renewcommand{\cftsubsecfont}{\normalsize\rmfamily}
\renewcommand{\cftsubsecpagefont}{\normalsize\rmfamily}
% Enlarge headings
\titleformat{\section}{\Large\bfseries}{\thesection}{0.6em}{}
\titleformat{\subsection}{\large\bfseries}{\thesubsection}{0.6em}{}
% Try several likely relative paths for images regardless of working directory
\graphicspath{{../images/}{images/}{docs/images/}{../docs/images/}}
\usepackage{etoolbox}

% Ensure ToC uses normal pagestyle and is followed by a page break
\pretocmd{\tableofcontents}{\thispagestyle{normal}}{}{}
\apptocmd{\tableofcontents}{\newpage}{}{}

% Ensure a page break after the title page without needing LaTeX in Markdown
\apptocmd{\maketitle}{\thispagestyle{plain}\newpage}{}{}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{geometry}

% Marges
\geometry{margin=2.5cm}
\setlength{\headheight}{48pt}

% Style "normal" : header avec logo à droite, trait, footer numéro de page centré
\fancypagestyle{normal}{%
  \fancyhf{}
  \fancyhead[R]{\includegraphics[height=1.0cm]{header.png}}
  \renewcommand{\headrulewidth}{0.4pt}
  \fancyfoot[C]{\thepage{} / \pageref{LastPage}}
}

% Style page de garde (page 1) : header totalement vide, ni logo ni trait ni numéro
\fancypagestyle{plain}{%
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  % rien dans l'en-tête ni le pied
}

% Pour forcer la table des matières sur une page après la page de garde,
% insère dans le markdown juste avant le ToC :
% \newpage
% \thispagestyle{normal}
% \tableofcontents
% \newpage
% Ainsi, la ToC est sur une page dédiée, avec header normal (logo à droite)

% Appliquer normal à tout le rapport sauf la page de garde (Pandoc = plain)
\pagestyle{normal}
